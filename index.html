<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="GoEV3 : LEGO Mindstorms EV3 API for Google Go" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>GoEV3</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/mattrajca/GoEV3">View on GitHub</a>

          <h1 id="project_title">GoEV3</h1>
          <h2 id="project_tagline">LEGO Mindstorms EV3 API for Google Go</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/mattrajca/GoEV3/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/mattrajca/GoEV3/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="goev3" class="anchor" href="#goev3"><span class="octicon octicon-link"></span></a>GoEV3</h1>

<h2>
<a name="introduction" class="anchor" href="#introduction"><span class="octicon octicon-link"></span></a>Introduction</h2>

<p>In 2013, LEGO introduced its third-generation Mindstorms robotics set, the <a href="http://en.wikipedia.org/wiki/Lego_Mindstorms_EV3">EV3</a>. Unlike its predecessors, the EV3 runs Linux, giving hackers and hobbyists the opportunity to create robots more capable than ever before.</p>

<p>The <a href="https://github.com/mindboards/ev3dev">ev3dev project</a> maintains open source, hacker-friendly releases of EV3's operating system. Distributions include built-in <a href="http://en.wikipedia.org/wiki/Secure_Shell">ssh</a> support and custom drivers for EV3's hardware. In fact, a simple file system-based interface can be used to interact with EV3's motors, sensors, buttons, and LEDs. Directories under <code>/sys/class</code> represent various device classes, and setting attributes is as simple as writing to files.</p>

<p>For example, executing the following shell commands will run a motor at 50% speed:</p>

<pre><code>echo  50 &gt; /sys/class/tacho-motor/outA:motor:tacho/speed_setpoint
echo   1 &gt; /sys/class/tacho-motor/outA:motor:tacho/run
</code></pre>

<p>This enables third-party developers to write EV3 bindings for any programming language that has a file system IO API.</p>

<p>GoEV3 provides EV3 bindings for <a href="http://golang.org">Google Go</a> (golang), allowing developers to take advantage of Go's modern syntax and extensive standard library to program Mindstorms robots.</p>

<h2>
<a name="getting-started" class="anchor" href="#getting-started"><span class="octicon octicon-link"></span></a>Getting Started</h2>

<h3>
<a name="ev3dev" class="anchor" href="#ev3dev"><span class="octicon octicon-link"></span></a>ev3dev</h3>

<p>First, we need to install ev3dev onto a Micro SD card (by using an SD card, we can keep EV3's built-in software intact). Instructions for the installation process can be found on <a href="https://github.com/mindboards/ev3dev/wiki/Getting-started-v2">ev3dev's wiki</a>. When you're done, reboot your EV3 and make sure you can ssh into it from your computer.</p>

<h3>
<a name="google-go" class="anchor" href="#google-go"><span class="octicon octicon-link"></span></a>Google Go</h3>

<p>Next, we need to install an ARMv5 build of Google Go. Fortunately for us, Go developer Dave Cheney released <a href="http://dave.cheney.net/unofficial-arm-tarballs">builds</a> of Go for various ARM architectures. On your computer, download the latest ARMv5 package (1.2 as of this writing). Once the download completes, transfer it to the EV3 over ssh using <a href="http://en.wikipedia.org/wiki/Secure_copy">scp</a>:</p>

<pre><code>scp /path/to/go1.2.linux-arm~armv5-1.tar.gz root@192.168.3.2:~/go.tar.gz
</code></pre>

<p>Be sure to replace <code>192.168.3.2</code> with your EV3's IP address. Now we can ssh into the EV3 and extract the archive to its final destination:</p>

<pre><code>cd /usr/local
tar -xf ~/go.tar.gz
</code></pre>

<p>Extraction may take a few minutes. Once it's done, we'll add Go's <code>bin</code> directory to our shell's path:</p>

<pre><code>echo "export PATH=\$PATH:/usr/local/go/bin" &gt;&gt; ~/.bashrc
source ~/.bashrc
</code></pre>

<p>We should now be able to invoke the <code>go</code> tool like so:</p>

<pre><code>root@ev3dev:~# go version
go version go1.2 linux/arm
</code></pre>

<h3>
<a name="goev3-1" class="anchor" href="#goev3-1"><span class="octicon octicon-link"></span></a>GoEV3</h3>

<p>Now that we have Google Go up and running, we need to install GoEV3. First, let's set up our Go workspace:</p>

<pre><code>cd ~
mkdir gocode
echo "export GOPATH=\$HOME/gocode" &gt;&gt; ~/.bashrc
source ~/.bashrc
</code></pre>

<p>We can obtain GoEV3 from its GitHub repository. Be sure to have internet connection sharing enabled prior to running the following commands:</p>

<pre><code>mkdir -p gocode/src/github.com/mattrajca
cd gocode/src/github.com/mattrajca
wget -O GoEV3.tar.gz --no-check-certificate https://github.com/mattrajca/GoEV3/archive/master.tar.gz
tar -xf GoEV3.tar.gz
mv GoEV3-master GoEV3
rm GoEV3.tar.gz
cd ~
</code></pre>

<p>Note we're not using <code>go get</code> to avoid installing <code>git</code> on the EV3.</p>

<p>GoEV3 comes with a sample program that lets us exercise EV3's various hardware capabilities. We can now run it with the following commands:</p>

<pre><code>go build github.com/mattrajca/GoEV3
gocode/bin/GoEV3
</code></pre>

<p>Choose mode <code>6. Motors</code>, plug in a motor to output port A, and watch it turn! Feel free to explore the other modes.</p>

<h2>
<a name="your-first-program" class="anchor" href="#your-first-program"><span class="octicon octicon-link"></span></a>Your First Program</h2>

<p>We'll now write a short Go program that drives a robot forward as long as there are no obstacles. To do this, we'll take advantage of the Sensors and Motor APIs.</p>

<p>First, let's create a new package, <code>example1</code>.</p>

<pre><code>mkdir ~/gocode/src/example1
cd ~/gocode/src/example1
nano main.go
</code></pre>

<p>Now paste in the following code:</p>

<pre><code>package main

import (
    "github.com/mattrajca/GoEV3/Motor"
    "github.com/mattrajca/GoEV3/Sensors"
    "time"
)

func main() {
    sensor := Sensors.FindInfraredSensor(Sensors.InPort2)

    Motor.Run(Motor.OutPortA, 40)
    Motor.Run(Motor.OutPortB, 40)

    for {
        value := sensor.ReadProximity()

        if value &lt; 50 {
            break
        }

        time.Sleep(time.Millisecond * 100)
    }

    Motor.Stop(Motor.OutPortA)
    Motor.Stop(Motor.OutPortB)
}
</code></pre>

<p>This code assumes we have an infrared sensor attached to input port 2 and two motors attached to output ports A and B.</p>

<p>To run the program, save the file, exit nano, and execute the following command:</p>

<pre><code>go run main.go
</code></pre>

<p>The motors on ports A and B will start turning. To stop them, simply extend your hand in front of the infrared sensor.</p>

<p>If you prefer writing and compiling Go programs on your computer, you can <a href="http://dave.cheney.net/2012/09/08/an-introduction-to-cross-compilation-with-go">cross-compile</a> an ARMv5 binary and transfer it to the EV3 over scp.</p>

<h2>
<a name="wi-fi-connectivity" class="anchor" href="#wi-fi-connectivity"><span class="octicon octicon-link"></span></a>Wi-Fi Connectivity</h2>

<p>Since attaching a USB cable to the EV3 isn't always convenient, instructions for setting up Wi-Fi access can be found <a href="https://github.com/mindboards/ev3dev/wiki/Setting-Up-wifi-Networking">here</a>.</p>

<h2>
<a name="auto-login--launcher" class="anchor" href="#auto-login--launcher"><span class="octicon octicon-link"></span></a>Auto Login + Launcher</h2>

<p>We can configure the EV3 to automatically log in to a program <a href="https://github.com/mattrajca/GoEV3-Launcher">launcher</a> at boot. First, edit <code>/etc/login.defs</code>:</p>

<pre><code>nano /etc/login.defs
</code></pre>

<p>Add the following line: <code>NO_PASSWORD_CONSOLE tty1:tty2:tty3:tty4:tty5:tty6</code></p>

<p>Now let's edit <code>/etc/inittab</code>:</p>

<pre><code>nano /etc/inittab
</code></pre>

<p>Find a line similar to <code>1:2345:respawn:/sbin/getty 38400 tty1</code> and change it to:</p>

<pre><code>1:2345:respawn:/sbin/getty --autologin root 38400 tty1
</code></pre>

<p>The EV3 will now automatically log in at boot. Next, we need to obtain the GoEV3 Launcher:</p>

<pre><code>cd ~/gocode/src/github.com/mattrajca
wget -O Launcher.tar.gz --no-check-certificate https://github.com/mattrajca/GoEV3-Launcher/archive/master.tar.gz
tar -xf Launcher.tar.gz
mv GoEV3-Launcher-master Launcher
rm Launcher.tar.gz
cd ~
</code></pre>

<p>Let's build it and try it out:</p>

<pre><code>go install github.com/mattrajca/Launcher
gocode/bin/Launcher
</code></pre>

<p>Select <code>GoEV3</code> and hit the Enter (center) button on the EV3.</p>

<p>Finally, let's configure the Launcher to run on login:</p>

<pre><code>nano ~/.bashrc
</code></pre>

<p>Add the following lines to the end of the file:</p>

<pre><code>if [ -z "$SSH_CLIENT" ]; then
    $GOPATH/bin/Launcher
fi
</code></pre>

<p>The GoEV3 Launcher will now run automatically on boot. Reboot the EV3 to try it out.</p>

<h2>
<a name="thread-safety" class="anchor" href="#thread-safety"><span class="octicon octicon-link"></span></a>Thread Safety</h2>

<p>All function and method calls in GoEV3 are thread-safe.</p>

<h2>
<a name="documentation" class="anchor" href="#documentation"><span class="octicon octicon-link"></span></a>Documentation</h2>

<p>The complete documentation for GoEV3 can be found on <a href="https://godoc.org/github.com/mattrajca/GoEV3">godoc</a>.</p>

<h2>
<a name="contributing" class="anchor" href="#contributing"><span class="octicon octicon-link"></span></a>Contributing</h2>

<p>GoEV3 is still in its early stages and subject to API changes as the ev3dev project evolves. Filing issues and submitting pull requests are the two best ways to get involved. Documentation improvements, new APIs, example programs, and bug fixes are all welcome.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">GoEV3 maintained by <a href="https://github.com/mattrajca">mattrajca</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
